<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Lehrer-Tracking (Fake-Echtzeit)</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="header">
    <div class="header-content">
      <h1>Lehrer-Tracking</h1>
      <p class="tagline">Pseudo-Echtzeit, komplett zufällig – nur zum Spaß</p>
    </div>
  </header>

  <nav class="navbar">
    <nav>
      <ul>
        <li><a href="#">Übersicht</a></li>
        <li><a href="#">Lehrer</a></li>
        <li><a href="#">Räume</a></li>
      </ul>
    </nav>
  </nav>

  <main>
    <div class="container content">
      <h2>Stundenplan / Raumplan</h2>
      <p>Die Räume und Zeiten sind fest, nur die Lehrernamen bewegen sich zufällig über den Plan.</p>

      <section class="card">
        <div class="timetable-wrapper">
          <table class="timetable" id="timetable">
            <thead>
              <tr>
                <th>Zeit / Raum</th>
                <th>A101</th>
                <th>A102</th>
                <th>A201</th>
                <th>B001</th>
                <th>B102</th>
                <th>Computerraum</th>
                <th>Werkraum</th>
                <th>Sporthalle</th>
                <th>Lehrerzimmer</th>
                <th>Sekretariat</th>
              </tr>
            </thead>
            <tbody>
              <!-- feste Zeiten; Räume bleiben, Lehrer werden per JS eingetragen -->
              <tr data-slot="0">
                <th>08:00–08:45</th>
                <td></td><td></td><td></td><td></td><td></td>
                <td></td><td></td><td></td><td></td><td></td>
              </tr>
              <tr data-slot="1">
                <th>08:50–09:35</th>
                <td></td><td></td><td></td><td></td><td></td>
                <td></td><td></td><td></td><td></td><td></td>
              </tr>
              <tr data-slot="2">
                <th>09:40–10:25</th>
                <td></td><td></td><td></td><td></td><td></td>
                <td></td><td></td><td></td><td></td><td></td>
              </tr>
              <tr data-slot="3">
                <th>10:40–11:25</th>
                <td></td><td></td><td></td><td></td><td></td>
                <td></td><td></td><td></td><td></td><td></td>
              </tr>
              <tr data-slot="4">
                <th>11:30–12:15</th>
                <td></td><td></td><td></td><td></td><td></td>
                <td></td><td></td><td></td><td></td><td></td>
              </tr>
              <tr data-slot="5">
                <th>12:20–13:05</th>
                <td></td><td></td><td></td><td></td><td></td>
                <td></td><td></td><td></td><td></td><td></td>
              </tr>
            </tbody>
          </table>
          <div class="legend">
            Aktualisierung in: <span id="countdown">--</span> s (dann werden alle Lehrernamen neu verteilt)
          </div>
        </div>
      </section>
    </div>
  </main>

  <footer>
    <p>Fake-Tracking &copy; 2025</p>
  </footer>

  <script>
    const teachers = [
      "Kabisch",
      "Fitzner",
      "Hoffmann",
      "Jabs",
      "Linnenkugel",
      "Blechmann",
      "Stark Charles",
      "Clever",
      "Böhmer",
      "Vermaeten"
    ];

    const REFRESH_MIN = 20;  // Sekunden
    const REFRESH_MAX = 60;  // Sekunden
    let refreshRemaining = 0;

    function randomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function pickRandomCells() {
      const tbody = document.querySelector("#timetable tbody");
      const rows = Array.from(tbody.querySelectorAll("tr"));
      const allCells = [];

      rows.forEach((row, rowIndex) => {
        const tds = Array.from(row.querySelectorAll("td"));
        tds.forEach((cell, colIndex) => {
          allCells.push({ cell, rowIndex, colIndex });
        });
      });

      // zuerst alles leeren
      allCells.forEach(({ cell }) => {
        cell.textContent = "";
        cell.classList.remove("teacher-cell");
      });

      // Lehrer auf zufällige, eindeutige Zellen verteilen
      const usedIndices = new Set();
      teachers.forEach(teacher => {
        if (usedIndices.size >= allCells.length) return;
        let idx;
        do {
          idx = randomInt(0, allCells.length - 1);
        } while (usedIndices.has(idx));
        usedIndices.add(idx);

        const target = allCells[idx].cell;
        target.textContent = teacher;
        target.classList.add("teacher-cell");
      });
    }

    function resetRefreshTimer() {
      refreshRemaining = randomInt(REFRESH_MIN, REFRESH_MAX);
      document.getElementById("countdown").textContent = refreshRemaining;
    }

    function tick() {
      refreshRemaining--;
      if (refreshRemaining <= 0) {
        pickRandomCells();
        resetRefreshTimer();
      } else {
        document.getElementById("countdown").textContent = refreshRemaining;
      }
    }

    // Initial
    pickRandomCells();
    resetRefreshTimer();
    setInterval(tick, 1000);
  </script>
</body>
</html>
